<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Thanh to√°n - C√† Ph√™ ƒê·∫≠m ƒê√†</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
        <link rel="stylesheet" href="styles/user.css" />
    </head>
    <body>
        <!-- Header (reuse) -->
        <header class="header">
  <div class="container nav">
    <div class="brand">
      <a href="index.html">
         <img src="https://scontent-hkg4-2.xx.fbcdn.net/v/t1.15752-9/552703956_771855105468883_1116774372539651057_n.png?_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_eui2=AeHOBCj3lX8HaOlEvmrFw3xlBrfZDT56J6MGt9kNPnono-ZY8pwnFeBxIqW3onZN3zta5vYTCGt1khW091oaxsr0&_nc_ohc=gpp9itW4IqcQ7kNvwEoG1Qq&_nc_oc=Admu0eUlmvebDWAO50DQbndetZfv1eoK4Pdnm2Fql2WZTtukjFnDuqMCp5j7orfE930&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent-hkg4-2.xx&oh=03_Q7cD3QHC08gLgVHXrZ8zt8znzke_wz-InehjvWetDnfV-WoDKQ&oe=68FBBCA9" alt="Logo C√† Ph√™ ƒê·∫≠m ƒê√†" class="brand-logo">
         <span class="brand-name">C√† Ph√™ ƒê·∫≠m ƒê√†</span>
      </a>
    </div>

    <form class="search-bar" role="search" id="searchForm" onsubmit="handleSearch(event)">
      <button class="search-btn" type="submit">üîç</button>
      <input type="text" id="searchInput" placeholder="T√¨m s·∫£n ph·∫©m..." aria-label="T√¨m ki·∫øm" />
    </form>

    <nav class="menu" aria-label="Ch√≠nh">
        <a href="products.html">S·∫£n ph·∫©m</a>
        <a href="index.html#ve-chung-toi">Gi·ªõi thi·ªáu</a>
        <a href="index.html#loi-ich">L·ª£i √≠ch</a>
        <a href="index.html#lien-he">Li√™n h·ªá</a>
        <a href="#gio-hang" class="badge" aria-label="Gi·ªè h√†ng">
            Gi·ªè h√†ng
            <span id="cart-badge" class="badge-count">0</span>
        </a>
    </nav>

    <button id="menuBtn" class="mobile-toggle" aria-expanded="false" aria-controls="mobileMenu">
      Menu
    </button>
  </div>
</header>

        <!-- Mobile menu (portal) -->
        <nav id="mobileMenu" hidden style="position: fixed; inset: 64px 16px auto; z-index: 60; background: var(--coffee-900); color: #fff; border-radius: 14px; padding: 14px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);"></nav>

        <!-- Cart Drawer (reuse) -->
        <div id="cartDrawerOverlay" hidden style="position: fixed; inset: 64px 0 0 0; background: rgba(0,0,0,0.5); z-index: 80;"></div>
        <aside id="cartDrawer" hidden aria-labelledby="cart-title" style="position: fixed; top: 64px; right: 0; height: calc(100vh - 64px); width: 420px; max-width: 95vw; background: #fff; color: #111; box-shadow: -10px 0 30px rgba(0,0,0,0.3); z-index: 90; display: flex; flex-direction: column; border-radius: 14px 0 0 14px; overflow: hidden;">
            <header style="display:flex; align-items:center; justify-content: space-between; padding: 16px; border-bottom: 1px solid #eee;">
                <div style="display:flex; align-items:center; gap:8px;">
                    <span style="display:inline-flex; width:24px; height:24px; align-items:center; justify-content:center; color:#c62828;">üõí</span>
                    <h3 id="cart-title" style="margin:0; font-size: 18px;">Gi·ªè h√†ng</h3>
                </div>
                <button id="closeCartBtn" aria-label="ƒê√≥ng gi·ªè h√†ng" style="background: transparent; border: none; font-size: 20px; cursor: pointer;">√ó</button>
            </header>
            <div id="cartItems" style="flex:1; overflow: auto; padding: 12px 16px;"></div>
            <footer style="padding: 16px; border-top: 1px solid #eee; background:#fff;">
                <div style="display:flex; align-items:center; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color:#333;">T·ªïng ti·ªÅn:</span>
                    <strong id="cartSubtotal" style="font-size:16px; color: var(--coffee, #4b3429);">0ƒë</strong>
                </div>
                <div style="display:flex; gap:12px;">
                    <button id="addMoreBtn" style="flex:1; padding: 12px 14px; background: #fff; color:#333; border: 1px solid #ddd; border-radius: 8px; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px;">
                        <span>Ôºã</span>
                        <span>Th√™m m√≥n</span>
                    </button>
                    <button id="checkoutBtn" style="flex:1; padding: 12px 14px; background: var(--gold); color: var(--coffee-900); border:none; border-radius: 8px; cursor:pointer; font-weight: 600;">Thanh to√°n</button>
                </div>
            </footer>
        </aside>

        <main class="container" style="padding: 24px 20px;">
            <h1 style="margin: 16px 0;">Thanh to√°n</h1>
            <div style="display:grid; grid-template-columns: 1.2fr 0.8fr; gap: 20px; align-items: start;">
                <!-- Customer form -->
                <section style="background:#fff; border-radius: 12px; padding:16px; box-shadow: 0 6px 18px rgba(0,0,0,0.06);">
                    <h3>Th√¥ng tin kh√°ch h√†ng</h3>
                    <div class="row" style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div>
                            <label>H·ªç v√† t√™n</label>
                            <input id="name" type="text" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:8px;" />
                        </div>
                        <div>
                            <label>S·ªë ƒëi·ªán tho·∫°i</label>
                            <input id="phone" type="tel" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:8px;" />
                        </div>
                        <div style="grid-column: span 2;">
                            <label>ƒê·ªãa ch·ªâ</label>
                            <input id="address" type="text" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:8px;" />
                        </div>
                        <div style="grid-column: span 2;">
                            <label>Ghi ch√∫</label>
                            <textarea id="note" rows="3" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:8px;"></textarea>
                        </div>
                    </div>
                    <div style="margin-top:14px; text-align:right;">
                        <button id="placeOrderBtn" style="padding:12px 16px; background: var(--coffee); color:#fff; border:none; border-radius:10px; cursor:pointer;">ƒê·∫∑t h√†ng</button>
                    </div>
                </section>

                <!-- Order summary -->
                <aside style="background:#fff; border-radius: 12px; padding:16px; box-shadow: 0 6px 18px rgba(0,0,0,0.06);">
                    <h3>ƒê∆°n h√†ng</h3>
                    <div id="summaryItems" style="margin-top: 10px;"></div>
                    <div style="display:flex; justify-content: space-between; margin-top:12px; font-weight:600;">
                        <span>T·ªïng c·ªông</span>
                        <span id="summaryTotal">0ƒë</span>
                    </div>
                </aside>
            </div>
        </main>

        <script src="scripts/user.js" defer></script>
        <script type="module">
            // Minimal utilities replicated from index for cart
            function formatCurrency(value) { return new Intl.NumberFormat('vi-VN').format(value); }
            function getCart() { try { return JSON.parse(localStorage.getItem('cart') || '[]'); } catch { return []; } }
            function setCart(cart) { localStorage.setItem('cart', JSON.stringify(cart)); }

            function updateCartBadge() {
                const cart = getCart();
                const badge = document.getElementById('cart-badge');
                if (badge) badge.textContent = cart.length;
            }

            function renderSummary() {
                const container = document.getElementById('summaryItems');
                const totalEl = document.getElementById('summaryTotal');
                const cart = getCart();
                if (cart.length === 0) {
                    container.innerHTML = '<p>Gi·ªè h√†ng tr·ªëng.</p>';
                    totalEl.textContent = '0ƒë';
                    return;
                }
                container.innerHTML = cart.map(i => `
                    <div style="display:flex; justify-content: space-between; padding:6px 0; border-bottom:1px dashed #eee;">
                        <span>${i.name} √ó ${i.quantity}</span>
                        <span>${formatCurrency(i.price * i.quantity)}ƒë</span>
                    </div>
                `).join('');
                const total = cart.reduce((s, i) => s + i.price * i.quantity, 0);
                totalEl.textContent = `${formatCurrency(total)}ƒë`;
            }

            // Drawer toggle like index
            function openCart() {
                renderCart();
                const drawer = document.getElementById('cartDrawer');
                const overlay = document.getElementById('cartDrawerOverlay');
                if (drawer && overlay) { drawer.hidden = false; overlay.hidden = false; }
            }
            function closeCart() {
                const drawer = document.getElementById('cartDrawer');
                const overlay = document.getElementById('cartDrawerOverlay');
                if (drawer && overlay) { drawer.hidden = true; overlay.hidden = true; }
            }
            function toggleCart() { const d = document.getElementById('cartDrawer'); if (!d) return; d.hidden ? openCart() : closeCart(); }

            function renderCart() {
                const container = document.getElementById('cartItems');
                const subtotalEl = document.getElementById('cartSubtotal');
                if (!container || !subtotalEl) return;
                const cart = getCart();
                if (cart.length === 0) { container.innerHTML = '<p>Gi·ªè h√†ng tr·ªëng.</p>'; subtotalEl.textContent = '0ƒë'; return; }
                container.innerHTML = cart.map(item => `
                    <div class="cart-item" data-id="${item.id}" style="padding: 12px 0; border-bottom: 1px solid #f2f2f2;">
                        <div style="display:flex; align-items:start; justify-content: space-between; gap: 10px;">
                            <div style="flex:1; min-width:0;">
                                <div style="font-weight:600;">${item.name}</div>
                                <div style="display:flex; align-items:center; gap:8px; margin-top:8px;">
                                    <button class="qty-dec" style="width:28px; height:28px; border:1px solid #ddd; background:#fff;">-</button>
                                    <input class="qty-input" type="number" min="1" value="${item.quantity}" style="width:48px; text-align:center; border:1px solid #ddd; height:28px;" />
                                    <button class="qty-inc" style="width:28px; height:28px; border:1px solid #ddd; background:#fff;">+</button>
                                    <button class="remove-item" style="margin-left:8px; background:#fff; border:1px solid #f2d7d7; color:#c62828; cursor:pointer; height:28px; padding:0 10px; border-radius:6px;">X√≥a</button>
                                </div>
                            </div>
                            <div style="min-width:100px; text-align:right; font-weight:600; color:var(--coffee);">${formatCurrency(item.price * item.quantity)}ƒë</div>
                        </div>
                    </div>
                `).join('');
                const subtotal = cart.reduce((s, i) => s + i.price * i.quantity, 0);
                subtotalEl.textContent = `${formatCurrency(subtotal)}ƒë`;
                container.querySelectorAll('.qty-dec').forEach(btn => btn.addEventListener('click', onDecQty));
                container.querySelectorAll('.qty-inc').forEach(btn => btn.addEventListener('click', onIncQty));
                container.querySelectorAll('.qty-input').forEach(inp => inp.addEventListener('change', onChangeQty));
                container.querySelectorAll('.remove-item').forEach(btn => btn.addEventListener('click', onRemoveItem));
            }

            function onDecQty(e){ const id = e.target.closest('.cart-item')?.dataset.id; const cart = getCart(); const it = cart.find(i=>i.id===id); if(!it) return; it.quantity=Math.max(1,it.quantity-1); setCart(cart); updateCartBadge(); renderCart(); renderSummary(); }
            function onIncQty(e){ const id = e.target.closest('.cart-item')?.dataset.id; const cart = getCart(); const it = cart.find(i=>i.id===id); if(!it) return; it.quantity+=1; setCart(cart); updateCartBadge(); renderCart(); renderSummary(); }
            function onChangeQty(e){ const id=e.target.closest('.cart-item')?.dataset.id; const v=Math.max(1,parseInt(e.target.value||'1',10)); const cart=getCart(); const it=cart.find(i=>i.id===id); if(!it) return; it.quantity=v; setCart(cart); updateCartBadge(); renderCart(); renderSummary(); }
            function onRemoveItem(e){ const id=e.target.closest('.cart-item')?.dataset.id; const next=getCart().filter(i=>i.id!==id); setCart(next); updateCartBadge(); renderCart(); renderSummary(); }

            // Events
            document.querySelector('a[aria-label="Gi·ªè h√†ng"]')?.addEventListener('click', (e)=>{ e.preventDefault(); toggleCart(); });
            document.getElementById('closeCartBtn')?.addEventListener('click', closeCart);
            document.getElementById('cartDrawerOverlay')?.addEventListener('click', closeCart);
            document.getElementById('addMoreBtn')?.addEventListener('click', ()=>{ closeCart(); window.location.href='index.html#san-pham'; });
            document.addEventListener('keydown', (ev)=>{ if(ev.key==='Escape') closeCart(); });

            // Place order (demo)
            document.getElementById('placeOrderBtn')?.addEventListener('click', ()=>{
                const name = document.getElementById('name').value.trim();
                const phone = document.getElementById('phone').value.trim();
                const address = document.getElementById('address').value.trim();
                if (!name || !phone || !address) { alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß H·ªç t√™n, SƒêT, ƒê·ªãa ch·ªâ.'); return; }
                alert('ƒê·∫∑t h√†ng th√†nh c√¥ng!');
                localStorage.removeItem('cart');
                updateCartBadge();
                renderSummary();
            });

            // Init page
            updateCartBadge();
            renderSummary();
            closeCart();
        </script>
    </body>
</html>


